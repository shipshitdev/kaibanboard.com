# Sessions: 2026-01-15

**Summary:** Monorepo restructure - CLI extraction

---

## Session 1: Monorepo Restructure for CLI Separation

**Duration:** ~45 minutes
**Status:** Complete

### What was done

- Restructured project from single package to monorepo with bun workspaces
- Created `packages/core` (@kaibanboard/core) - shared types and task parser
- Created `packages/cli` (@kaibanboard/cli) - standalone terminal TUI with `kai` command
- Created `packages/vscode` (kaibanboardcom) - Cursor extension
- Removed CLI dependencies from VS Code extension (ink, react, chokidar, meow, react-devtools-core)
- Cleaned up old `src/`, `bin/`, `tsconfig.cli.json`

### Files created

- `packages/core/package.json` - @kaibanboard/core package config
- `packages/core/tsconfig.json` - Core TypeScript config
- `packages/core/src/index.ts` - Core exports
- `packages/core/src/types.ts` - Shared Task/TaskStatus/TaskPriority types
- `packages/core/src/taskParser.ts` - CoreTaskParser class
- `packages/cli/package.json` - @kaibanboard/cli with bin: { kai: ... }
- `packages/cli/tsconfig.json` - CLI TypeScript config
- `packages/cli/src/index.tsx` - CLI entry point
- `packages/cli/src/app.tsx` - Main TUI application
- `packages/cli/src/components/*.tsx` - Board, Column, TaskCard, TaskDetail, StatusBar, Help
- `packages/cli/src/hooks/*.ts` - useTasks, useNavigation, useCLI
- `packages/cli/src/utils/*.ts` - colors, executeTask
- `packages/cli/src/services/cliDetectionService.ts` - CLI detection
- `packages/cli/src/types/cli.ts` - CLI types
- `packages/vscode/package.json` - Cursor extension config (cleaned dependencies)
- `packages/vscode/tsconfig.json` - Extension TypeScript config
- `packages/vscode/src/*` - All extension source files with updated imports

### Files modified

- `package.json` - Converted to monorepo root with workspaces config

### Files deleted

- `src/` - Entire old source directory (moved to packages/)
- `bin/` - Old CLI bin directory
- `tsconfig.cli.json` - Old CLI TypeScript config
- `src/core/` - Moved to packages/core
- `src/cli/` - Moved to packages/cli

### Decisions

- **Decision:** Separate CLI into standalone npm package
  - **Context:** CLI was bloating the VS Code extension with ~2MB of dependencies (ink, react, chokidar, meow, react-devtools-core) that Cursor users don't need
  - **Rationale:** CLI published independently to npm allows global install, extension stays lean

- **Decision:** Use bun workspaces for monorepo
  - **Context:** Need to share core types/parser between CLI and extension
  - **Rationale:** Bun workspaces provide simple linking with workspace:* protocol

- **Decision:** CLI command name `kai`
  - **Context:** User preference for short, memorable command
  - **Rationale:** Short, unique, easy to type in terminal

### Architecture

```
packages/
├── core/                    # @kaibanboard/core (shared, internal)
│   └── src/
│       ├── index.ts         # Exports
│       ├── types.ts         # Task, TaskStatus, TaskPriority
│       └── taskParser.ts    # CoreTaskParser class
├── cli/                     # @kaibanboard/cli (npm package)
│   └── src/
│       ├── index.tsx        # Entry: kai command
│       ├── app.tsx          # Main TUI
│       ├── components/      # React/Ink components
│       ├── hooks/           # Custom hooks
│       ├── services/        # CLI detection
│       ├── types/           # CLI-specific types
│       └── utils/           # Colors, execution
└── vscode/                  # kaibanboardcom (Cursor extension)
    └── src/
        ├── extension.ts     # VS Code entry
        ├── kanbanView.ts    # Webview provider
        ├── taskParser.ts    # VS Code adapter for CoreTaskParser
        └── ...              # Services, utils
```

### Next steps

- [ ] Run `bun install` to link workspaces
- [ ] Run `bun run build` to verify compilation
- [ ] Test CLI: `cd packages/cli && bun run build && node dist/index.js`
- [ ] Test extension: `cd packages/vscode && bun run compile`
- [ ] Publish @kaibanboard/cli to npm
- [ ] Package and publish Cursor extension

---

## Session 2: READMEs, Namespace & Config Fixes

**Duration:** ~15 minutes
**Status:** Complete

### What was done

- Created @kaibanboard npm organization namespace
- Created separate READMEs for each distribution channel
- Updated inbox with QA checklist
- User fixed core package config for CommonJS compatibility

### Files created

- `packages/vscode/README.md` - Extension store focused README
- `packages/cli/README.md` - npm package focused README

### Files modified

- `README.md` - Updated root README with monorepo structure, quick start for both CLI and extension
- `.agent/TASKS/INBOX.md` - Added QA checklist for monorepo release
- `.agent/SESSIONS/2026-01-15.md` - Session documentation
- `packages/core/package.json` - User changed to CommonJS exports
- `packages/core/tsconfig.json` - User changed to commonjs module
- `packages/core/src/index.ts` - User removed .js extensions
- `packages/core/src/taskParser.ts` - User removed .js extensions
- `packages/vscode/package.json` - User added scss build scripts

### Decisions

- **Decision:** Separate READMEs per distribution channel
  - **Context:** Extension store and npm have different audiences
  - **Rationale:** Each README focuses on relevant install/usage for that channel

- **Decision:** Core package uses CommonJS
  - **Context:** VS Code extensions require CommonJS modules
  - **Rationale:** User changed core to CommonJS to fix import compatibility with extension

### External actions

- Created @kaibanboard npm organization at https://www.npmjs.com/org/kaibanboard

### Next steps

See `.agent/TASKS/INBOX.md` for remaining QA checklist

---

## Session 3: Convert CSS to SCSS

**Duration:** ~20 minutes
**Status:** Complete

### What was done

- Installed sass as dev dependency
- Converted `media/styles.css` (1,718 lines) to SCSS
- Moved `media/` folder from project root to `packages/vscode/media/` (correct location for monorepo)
- Added SCSS variables for colors, spacing, border-radius, transitions
- Created scrollbar mixin to replace 3 duplicate implementations
- Replaced hardcoded hex colors with SCSS variables throughout file
- Added SCSS build scripts to packages/vscode/package.json
- Fixed monorepo ESM/CommonJS module compatibility issues (composite: true)

### Files created

- `packages/vscode/media/styles.scss` - SCSS source (34KB)
- `packages/vscode/media/styles.css` - Compiled output (32KB)
- `packages/vscode/media/styles.css.map` - Source map for debugging

### Files modified

- `packages/vscode/package.json` - Added scss:build, scss:watch scripts; updated compile script
- `packages/core/tsconfig.json` - Added composite: true for project references
- `package.json` (root) - sass added as dev dependency

### Files moved

- `media/` → `packages/vscode/media/` (entire folder)

### Decisions

- **Decision:** Use single SCSS file (no partials)
  - **Context:** 1,718 lines of CSS, user wanted simple setup
  - **Rationale:** Variables at top, clean organization, easier to maintain

- **Decision:** Keep compiled CSS in git
  - **Context:** Could exclude and compile on install
  - **Rationale:** Easier distribution, no build step required for contributors

### SCSS Variables Added

```scss
// Colors - Status
$color-success: #22c55e;
$color-error: #ef4444;
$color-warning: #eab308;
$color-indigo: #6366f1;

// Colors - Column Status
$color-backlog, $color-todo, $color-doing, $color-testing, $color-done, $color-blocked

// Colors - Providers
$color-cursor, $color-openai, $color-openrouter, $color-replicate

// Spacing scale
$spacing-xs through $spacing-2xl

// Border radius
$radius-sm through $radius-pill

// Transitions
$transition-fast, $transition-base, $transition-slow
```

### Build Scripts Added

```json
{
  "scss:build": "sass media/styles.scss media/styles.css",
  "scss:watch": "sass --watch media/styles.scss:media/styles.css",
  "compile": "bun run scss:build && tsc -p ./"
}
```

### Verification

- Full build passes: `bun run build` compiles core, cli, and vscode packages
- SCSS compiles without errors
- CSS output is valid and smaller (32KB vs 34KB SCSS)

---

## Session 4: Feature Gap Analysis & Roadmap Creation

**Duration:** ~30 minutes
**Status:** Complete

### What was done

- Analyzed Auto-Claude OSS project (https://github.com/VincentShipsIt/Auto-Claude) for feature gaps
- Identified 12 features missing from Kaiban Board compared to Auto-Claude
- Created comprehensive PRDs for all 12 features
- Created task files for all 12 features with priority ordering
- Established feature roadmap for future development

### Feature Gap Analysis

Compared Auto-Claude capabilities with current Kaiban Board features:

**Already Have (Parity):**
- Kanban Board with drag-drop
- Multi-CLI execution (Claude/Codex/Cursor)
- Batch execution
- CLI tool (`kai`)
- Real-time progress tracking
- PRD management

**Identified Gaps (12 features):**

| Priority | Feature | Complexity |
|----------|---------|------------|
| High | CLI Stability & Testing | Medium |
| High | Changelog Generator | Easy |
| High | GitHub/GitLab Integration | Medium |
| High | Parallel Agent Terminals (up to 12) | Medium |
| High | Git Worktree Isolation | Medium |
| Medium | Cross-Session Memory | Medium |
| Medium | Codebase Insights Chat | Hard |
| Medium | Roadmap Generator | Medium |
| Medium | Linear Integration | Easy |
| Medium | Vulnerability Scanner | Medium |
| Low | Dynamic Command Allowlist | Hard |
| Low | Desktop App (Electron) | Hard |

### Files created

**PRDs (12 files in `.agent/PRDS/`):**
- `cli-stability-testing.md` - Tests, CI/CD, coverage for CLI
- `changelog-generator.md` - Auto-generate release notes
- `github-integration.md` - Import issues, create PRs
- `parallel-agent-terminals.md` - Concurrent execution
- `git-worktree-isolation.md` - Safe isolated branches
- `cross-session-memory.md` - Persistent agent learnings
- `codebase-insights-chat.md` - Natural language codebase Q&A
- `roadmap-generator.md` - AI-assisted feature planning
- `linear-integration.md` - Sync with Linear
- `vulnerability-scanner.md` - Security/performance scanning
- `dynamic-command-allowlist.md` - Stack-based command security
- `desktop-app.md` - Electron desktop application

**Tasks (12 files in `.agent/TASKS/`):**
- `cli-stability-testing.md` (Order: 1, Priority: High)
- `changelog-generator.md` (Order: 2, Priority: High)
- `github-integration.md` (Order: 3, Priority: High)
- `parallel-agent-terminals.md` (Order: 4, Priority: High)
- `git-worktree-isolation.md` (Order: 5, Priority: High)
- `cross-session-memory.md` (Order: 6, Priority: Medium)
- `codebase-insights-chat.md` (Order: 7, Priority: Medium)
- `roadmap-generator.md` (Order: 8, Priority: Medium)
- `linear-integration.md` (Order: 9, Priority: Medium)
- `vulnerability-scanner.md` (Order: 10, Priority: Medium)
- `dynamic-command-allowlist.md` (Order: 11, Priority: Low)
- `desktop-app.md` (Order: 12, Priority: Low)

### Decisions

- **Decision:** Prioritize CLI stability first
  - **Context:** CLI was just extracted to separate package, needs validation
  - **Rationale:** Foundation must be solid before adding features

- **Decision:** Changelog generator as quick win
  - **Context:** We already track completed tasks
  - **Rationale:** Low effort, high value - generates release notes automatically

- **Decision:** Use `gh`/`glab` CLI for GitHub/GitLab integration
  - **Context:** Could use API directly or CLI tools
  - **Rationale:** Leverages existing user authentication, no token management needed

- **Decision:** Desktop app as low priority
  - **Context:** Would provide standalone experience outside VS Code
  - **Rationale:** High effort, VS Code extension covers primary use case

### Roadmap Flow

```
┌─────────────────────────────────────────────────────────────┐
│                    HIGH PRIORITY                            │
├─────────────────────────────────────────────────────────────┤
│  CLI Stability → Changelog → GitHub → Parallel → Worktree  │
│      (1)           (2)        (3)       (4)        (5)      │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                   MEDIUM PRIORITY                           │
├─────────────────────────────────────────────────────────────┤
│  Memory → Insights Chat → Roadmap → Linear → Vuln Scanner  │
│   (6)        (7)           (8)       (9)        (10)        │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                    LOW PRIORITY                             │
├─────────────────────────────────────────────────────────────┤
│         Command Allowlist → Desktop App                     │
│              (11)              (12)                         │
└─────────────────────────────────────────────────────────────┘
```

### Next steps

- [ ] Complete Human QA checklist in INBOX.md (blocking production)
- [ ] Start with CLI Stability & Testing task
- [ ] Implement Changelog Generator (quick win)
- [ ] Plan GitHub Integration implementation

---

**Total sessions today:** 4
