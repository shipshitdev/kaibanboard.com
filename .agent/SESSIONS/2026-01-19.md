# Session: 2026-01-19

**Summary:** Add review workflow columns with agent assignment

---

## Session 1: Implement Review Workflow Columns

**Status:** Complete

### What was done

Implemented a new multi-agent review workflow with restructured Kanban columns:

**New Column Structure:**
```
Backlog → Planning → In Progress → AI Review → Human Review → Done
                                                              ↓
                                              Archived (hidden by default)
                                              Blocked (hidden by default)
```

**Key Changes:**
1. Updated `TaskStatus` type with new values: `Backlog`, `Planning`, `In Progress`, `AI Review`, `Human Review`, `Done`, `Archived`, `Blocked`
2. Added `AgentType` type: `"Claude Code" | "Codex" | "None"`
3. Added `COLUMN_DEFAULT_AGENTS` mapping for default agent per column
4. Added `assignedAgent` field to Task interface for per-task overrides
5. Added parsing for `**Assigned-Agent:**` metadata in task files
6. Updated all UI components, styles, and CLI to use new column names
7. Added `kaiban.columns.agents` VS Code configuration for per-column agent defaults

### Files changed

**Core Package:**
- `packages/core/src/types.ts` - New TaskStatus union, AgentType, COLUMN_DEFAULT_AGENTS, assignedAgent field
- `packages/core/src/taskParser.ts` - Updated groupByStatus(), added agent parsing, changed default status to "Backlog"

**VSCode Extension:**
- `packages/vscode/src/kanbanView.ts` - Updated allColumns, enabledColumns, empty messages, status checks
- `packages/vscode/src/extension.ts` - Updated allValidColumns, default columns, create task prompt
- `packages/vscode/media/styles.scss` - Added colors for new statuses (Planning=purple, In Progress=amber, AI Review=cyan, Human Review=pink, Archived=slate)
- `packages/vscode/package.json` - Updated columns.enabled schema, added columns.agents config
- `packages/vscode/src/services/taskGenerator.test.ts` - Updated test to use "Planning" status

**CLI Package:**
- `packages/cli/src/utils/colors.ts` - Updated STATUS_COLORS mapping
- `packages/cli/src/app.tsx` - Updated default columns
- `packages/cli/src/index.tsx` - Updated validColumns and help text
- `packages/cli/src/utils/executeTask.ts` - Changed status update to "In Progress"

### Decisions

- **Decision:** Map old statuses to new ones
  - `"To Do"` → `"Backlog"` or `"Planning"`
  - `"Doing"` → `"In Progress"`
  - `"Testing"` → `"AI Review"` or `"Human Review"`
  - **Rationale:** Planning is for tasks being planned by agents, In Progress for execution, and review columns separate AI and human review steps

- **Decision:** Default visible columns exclude Archived and Blocked
  - **Rationale:** These are meant to be hidden by default, toggled on when needed

- **Decision:** "Play All" button shows on Planning column
  - **Rationale:** Planning is the staging area where tasks are ready to be picked up for agent execution

### Patterns established

- Agent assignment can be overridden per-task using `**Assigned-Agent:**` metadata field
- Column agent defaults are configured in VS Code settings under `kaiban.columns.agents`
- Default agents: Planning=Claude Code, In Progress=Claude Code, AI Review=Codex

### Next steps

- [ ] Compile and test the extension to verify all changes work correctly
- [ ] Test drag-and-drop between new columns
- [ ] Verify CLI displays all columns with correct colors
- [ ] Test creating tasks with `**Assigned-Agent:** Codex` override

---

**Total sessions today:** 1
